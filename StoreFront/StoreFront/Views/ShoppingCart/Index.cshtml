@model Dictionary<int, StoreFront.Models.CartItemViewModel>
@{


    ViewData["Title"] = "Cart";

    decimal? cartTotal = 0;

}

  <div class="page-heading" id="top">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="inner-content">
                        <h2>Your Shopping Cart</h2>
                        <span>Checkout What Products You Have Added</span>
                    </div>
                </div>
            </div>
        </div>
    </div>



<section class="product_section layout_padding">

            <g>

            </g>
             <g>

            </g>

            <p align="center">

                <a asp-action="TiledProducts" asp-controller="Products"  class="btn btn-info">Back to shopping</a>
            </p>
             <g>

            </g>
             <g>

            </g>
        </div>

        @if (Model.Count == 0)
        {
            <p class="alert alert-warning text-center">
                @ViewBag.Message
            </p>
        }
        else
        {
            <table class= "table">
                <thead>
                    <tr>
                        <th>Products</th>
                         <th>Quantity</th>
                          <th>Name</th>
                           <th>Price</th>
                            <th>Total</th>
                             <th></th>

                    </tr>

                </thead>

                <tbody>

                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>
                                <img src="~/assets/images/t_@item.Value.Product.Img" alt="@item.Value.Product.Pname"/>


                            </td>

                            <td>
                                @item.Value.Qty
                            </td>
                            <td>
                                @item.Value.Product.Pname
                            </td>
                            <td>
                                @item.Value.Product.Pprice
                            </td>
                            <td>
                                @{
                                    //Calculate the line total and the cart total
                                        //line totatl will be displayed here for each individual line item
                                        //cart totalt will be displayed aftter al;l of the lime itmes

                                    decimal? lineTotal = item.Value.Qty * item.Value.Product.Pprice;
                                    cartTotal += lineTotal;
                                }

                                @lineTotal

                            </td>
                            <td>
                                <a asp-controller="ShoppingCart" asp-action="RemoveFromCart" asp-route-id="@item.Key" class="btn btn-danger">
                                Remove From Cart
                                </a>

                            </td>
                        </tr>
                    }

                </tbody>
            </table>

            <div class= "alert alert-success text-center">
           <p>
               Your total before tax and shipping is @cartTotal.
           </p>
            </div>
        }




    </div>
</section>


